<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Personal History App</title>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <style>
 <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
    
    <style>
 <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    
<style>
    body { 
        font-family: 'Inter', sans-serif; 
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        margin: 0; 
        display: flex; 
        justify-content: center; 
        min-height: 100vh;
        padding: 20px;
        box-sizing: border-box;
    }
    
    /* The Main Card Container */
    .app-wrapper {
        width: 100%;
        max-width: 500px;
        background: white;
        min-height: calc(100vh - 40px);
        box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        display: flex;
        flex-direction: column;
        border-radius: 24px;
        overflow: hidden;
    }
    
    /* Header Style */
    header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        padding: 24px;
        border-bottom: none;
        display: flex;
        justify-content: space-between;
        align-items: center;
        position: sticky;
        top: 0;
        z-index: 10;
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    
    h2 { 
        margin: 0; 
        font-size: 1.4rem; 
        color: white;
        font-weight: 700;
        letter-spacing: -0.5px;
    }
    
    .user-email { 
        font-size: 0.75rem; 
        color: rgba(255,255,255,0.8);
        background: rgba(255,255,255,0.1);
        padding: 6px 12px;
        border-radius: 20px;
        backdrop-filter: blur(10px);
    }
    
    /* Login Screen */
    #login-container {
        padding: 50px 40px;
        text-align: center;
        margin-top: 30px;
    }
    
    #login-container h2 {
        color: #111;
        font-size: 2rem;
        margin-bottom: 10px;
    }
    
    #login-container p {
        color: #666;
        margin-bottom: 30px;
    }
    
    /* Inputs & Buttons */
    input { 
        width: 100%; 
        padding: 16px 20px; 
        margin-bottom: 15px; 
        border: 2px solid #e5e7eb; 
        border-radius: 16px; 
        background: #f9fafb;
        font-size: 1rem;
        box-sizing: border-box;
        transition: all 0.2s ease;
        font-family: 'Inter', sans-serif;
    }
    
    input:focus { 
        outline: none; 
        border-color: #667eea; 
        background: white;
        box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
    }
    
    button { 
        width: 100%; 
        padding: 16px; 
        border: none; 
        border-radius: 16px; 
        font-weight: 600; 
        cursor: pointer; 
        font-size: 1rem;
        transition: all 0.2s ease;
        font-family: 'Inter', sans-serif;
    }
    
    button.primary { 
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white; 
        margin-bottom: 10px;
        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
    }
    
    button.primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(102, 126, 234, 0.5);
    }
    
    button.secondary { 
        background-color: #f3f4f6; 
        color: #374151;
        border: 2px solid #e5e7eb;
    }
    
    button.secondary:hover {
        background-color: #e5e7eb;
    }
    
    button:active { 
        transform: scale(0.98); 
    }
    
    /* The List of Notes */
    #app-container { 
        padding: 24px; 
        flex-grow: 1; 
        display: flex; 
        flex-direction: column;
        overflow-y: auto;
    }
    
    ul { 
        list-style: none; 
        padding: 0; 
        margin: 0;
    }
    
    li { 
        background: linear-gradient(135deg, #f9fafb 0%, #ffffff 100%);
        border: 2px solid #e5e7eb;
        padding: 18px 20px; 
        border-radius: 16px; 
        margin-bottom: 12px; 
        box-shadow: 0 2px 8px rgba(0,0,0,0.04);
        animation: fadeIn 0.4s ease;
        word-wrap: break-word;
        transition: all 0.2s ease;
        position: relative;
        overflow: hidden;
    }
    
    li::before {
        content: '';
        position: absolute;
        left: 0;
        top: 0;
        height: 100%;
        width: 4px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }
    
    li:hover {
        transform: translateX(4px);
        box-shadow: 0 4px 16px rgba(0,0,0,0.08);
        border-color: #667eea;
    }
    
    /* Input Area at the bottom */
    .input-area {
        position: sticky;
        bottom: 0;
        background: white;
        padding: 20px;
        border-top: 2px solid #f3f4f6;
        box-shadow: 0 -4px 12px rgba(0,0,0,0.05);
    }
    
    .input-area input {
        margin-bottom: 12px;
    }
    
    .hidden { 
        display: none !important; 
    }
    
    /* Empty State */
    .empty-state {
        text-align: center;
        padding: 60px 20px;
        color: #9ca3af;
    }
    
    .empty-state h3 {
        font-size: 1.2rem;
        margin-bottom: 8px;
        color: #6b7280;
    }
    
    @keyframes fadeIn { 
        from { 
            opacity: 0; 
            transform: translateY(10px); 
        } 
        to { 
            opacity: 1; 
            transform: translateY(0); 
        } 
    }
    
    /* Responsive adjustments */
    @media (max-width: 600px) {
        body {
            padding: 0;
        }
        
        .app-wrapper {
            border-radius: 0;
            min-height: 100vh;
        }
    }
</style>
    </style>
    </style>
</head>
<body>
<div class="app-wrapper">
    
    <div id="login-container">
        <div class="login-icon">üîê</div>
        <h1>Welcome Back</h1>
        <p class="subtitle">Login to access your private notes</p>
        
        <div class="input-group">
            <div class="input-wrapper">
                <span class="input-icon">üìß</span>
                <input type="email" id="email" placeholder="name@example.com">
            </div>
            
            <div class="input-wrapper">
                <span class="input-icon">üîí</span>
                <input type="password" id="password" placeholder="Password">
            </div>
        </div>
        
        <button class="primary" onclick="login()">
            <span>Log In</span>
            <span class="button-arrow">‚Üí</span>
        </button>
        <button class="secondary" onclick="signUp()">Create Account</button>
        
        <p class="footer-text">Your notes are encrypted and secure</p>
    </div>
    
    <div id="app-container" class="hidden">
        <header>
            <div class="header-content">
                <div class="header-icon">üìù</div>
                <div>
                    <h2>My Notes</h2>
                    <span id="user-display" class="user-email"></span>
                </div>
            </div>
            <button class="logout-btn" onclick="logout()">
                <span>Log Out</span>
                <span class="logout-icon">üëã</span>
            </button>
        </header>
        
        <div class="notes-container">
            <ul id="messageList"></ul>
            <div class="empty-state hidden" id="emptyState">
                <div class="empty-icon">üì≠</div>
                <h3>No notes yet</h3>
                <p>Start by adding your first note below</p>
            </div>
        </div>
        
        <div class="input-area">
            <div class="input-controls">
                <input type="text" id="messageInput" placeholder="‚ú® Type a new note..." onkeypress="if(event.key==='Enter') addMessage()">
                <button class="send-btn primary" onclick="addMessage()">
                    <span class="send-icon">‚û§</span>
                </button>
            </div>
        </div>
    </div>
</div>

<style>
    /* Enhanced Login Styles */
    #login-container {
        padding: 50px 40px;
        text-align: center;
        animation: fadeIn 0.5s ease;
    }
    
    .login-icon {
        font-size: 3.5rem;
        margin-bottom: 20px;
        animation: bounce 1s ease infinite;
    }
    
    @keyframes bounce {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-10px); }
    }
    
    #login-container h1 {
        color: #111;
        font-size: 2.2rem;
        margin-bottom: 10px;
        font-weight: 700;
        letter-spacing: -1px;
    }
    
    .subtitle {
        color: #6b7280;
        margin-bottom: 35px;
        font-size: 0.95rem;
    }
    
    .input-group {
        margin-bottom: 25px;
    }
    
    .input-wrapper {
        position: relative;
        margin-bottom: 15px;
    }
    
    .input-icon {
        position: absolute;
        left: 18px;
        top: 50%;
        transform: translateY(-50%);
        font-size: 1.2rem;
        pointer-events: none;
        z-index: 1;
    }
    
    .input-wrapper input {
        padding-left: 52px;
    }
    
    .button-arrow {
        margin-left: 8px;
        display: inline-block;
        transition: transform 0.2s ease;
    }
    
    button.primary:hover .button-arrow {
        transform: translateX(4px);
    }
    
    .footer-text {
        margin-top: 25px;
        color: #9ca3af;
        font-size: 0.8rem;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 6px;
    }
    
    .footer-text::before {
        content: 'üîí';
        font-size: 0.9rem;
    }
    
    /* Enhanced Header */
    header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        padding: 20px 24px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        position: sticky;
        top: 0;
        z-index: 10;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }
    
    .header-content {
        display: flex;
        align-items: center;
        gap: 12px;
    }
    
    .header-icon {
        font-size: 2rem;
        background: rgba(255,255,255,0.2);
        width: 50px;
        height: 50px;
        border-radius: 14px;
        display: flex;
        align-items: center;
        justify-content: center;
        backdrop-filter: blur(10px);
    }
    
    .logout-btn {
        background: rgba(255,255,255,0.2);
        color: white;
        border: 2px solid rgba(255,255,255,0.3);
        padding: 10px 18px;
        font-size: 0.85rem;
        display: flex;
        align-items: center;
        gap: 6px;
        backdrop-filter: blur(10px);
        transition: all 0.2s ease;
    }
    
    .logout-btn:hover {
        background: rgba(255,255,255,0.3);
        transform: translateY(-2px);
    }
    
    .logout-icon {
        font-size: 1rem;
    }
    
    /* Notes Container */
    .notes-container {
        flex-grow: 1;
        overflow-y: auto;
        padding: 24px;
    }
    
    /* Empty State */
    .empty-state {
        text-align: center;
        padding: 80px 20px;
        color: #9ca3af;
    }
    
    .empty-icon {
        font-size: 4rem;
        margin-bottom: 20px;
        opacity: 0.5;
    }
    
    .empty-state h3 {
        font-size: 1.3rem;
        margin-bottom: 8px;
        color: #6b7280;
        font-weight: 600;
    }
    
    .empty-state p {
        color: #9ca3af;
        font-size: 0.95rem;
    }
    
    /* Enhanced List Items */
    ul {
        list-style: none;
        padding: 0;
        margin: 0;
    }
    
    li {
        background: white;
        border: 2px solid #e5e7eb;
        padding: 18px 20px 18px 24px;
        border-radius: 16px;
        margin-bottom: 12px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.04);
        animation: slideIn 0.4s ease;
        word-wrap: break-word;
        transition: all 0.2s ease;
        position: relative;
        overflow: hidden;
        font-size: 0.95rem;
        line-height: 1.6;
        color: #374151;
    }
    
    li::before {
        content: '';
        position: absolute;
        left: 0;
        top: 0;
        height: 100%;
        width: 5px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }
    
    li:hover {
        transform: translateX(6px);
        box-shadow: 0 4px 16px rgba(102, 126, 234, 0.15);
        border-color: #667eea;
    }
    
    @keyframes slideIn {
        from {
            opacity: 0;
            transform: translateX(-20px);
        }
        to {
            opacity: 1;
            transform: translateX(0);
        }
    }
    
    /* Enhanced Input Area */
    .input-area {
        position: sticky;
        bottom: 0;
        background: white;
        padding: 20px 24px;
        border-top: 2px solid #f3f4f6;
        box-shadow: 0 -4px 12px rgba(0,0,0,0.05);
    }
    
    .input-controls {
        display: flex;
        gap: 12px;
        align-items: center;
    }
    
    .input-controls input {
        flex: 1;
        margin: 0;
        font-size: 0.95rem;
    }
    
    .send-btn {
        width: 56px;
        height: 56px;
        padding: 0;
        margin: 0;
        border-radius: 16px;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
    }
    
    .send-icon {
        font-size: 1.3rem;
        display: inline-block;
        transition: transform 0.2s ease;
    }
    
    .send-btn:hover .send-icon {
        transform: translateX(3px);
    }
    
    .send-btn:active .send-icon {
        transform: scale(0.9);
    }
</style>
    <script>
        // --- 1. CONFIGURATION ---
        const SUPABASE_URL = 'https://jcoucgppzopppqaflhot.supabase.co'; // Paste your URL here
        const SUPABASE_KEY = 'sb_publishable_CUvcKUf28jz2qJstu7Iaqw_P4L_Igv-'; // Paste your Key here
        
        const { createClient } = supabase;
        const _supabase = createClient(SUPABASE_URL, SUPABASE_KEY);

        // --- 2. AUTHENTICATION ---
        let currentUser = null;

        _supabase.auth.onAuthStateChange((event, session) => {
            if (session) {
                currentUser = session.user;
                document.getElementById('login-container').classList.add('hidden');
                document.getElementById('app-container').classList.remove('hidden');
                document.getElementById('user-display').textContent = `Logged in as: ${currentUser.email}`;
                fetchMessages(); // Load THIS user's history
            } else {
                currentUser = null;
                document.getElementById('login-container').classList.remove('hidden');
                document.getElementById('app-container').classList.add('hidden');
            }
        });

        async function signUp() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const { error } = await _supabase.auth.signUp({ email, password });
            if (error) alert(error.message);
            else alert("Account created! You can now Log In.");
        }

        async function login() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const { error } = await _supabase.auth.signInWithPassword({ email, password });
            if (error) alert(error.message);
        }

        async function logout() {
            await _supabase.auth.signOut();
        }

        // --- 3. DATABASE (The "Private History" Logic) ---
        async function fetchMessages() {
            if (!currentUser) return;

            const { data, error } = await _supabase
                .from('messages')
                .select('*')
                .eq('user_email', currentUser.email); // <--- FILTER: Show only MY data

            const list = document.getElementById('messageList');
            list.innerHTML = ''; 

            if (data) {
                data.forEach(msg => {
                    const li = document.createElement('li');
                    li.textContent = msg.content;
                    list.appendChild(li);
                });
            }
        }

        async function addMessage() {
            const input = document.getElementById('messageInput');
            const text = input.value;
            if (!text) return;

            const { error } = await _supabase
                .from('messages')
                .insert({ content: text, user_email: currentUser.email });

            if (!error) {
                input.value = '';
                fetchMessages();
            } else {
                alert('Error: ' + error.message);
            }
        }
    </script>
</body>

</html>


